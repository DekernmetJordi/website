---
import { Image } from "astro:assets";
import Jordi from "../../public/images/Jordi_coachen_kleiner.jpg";

// Lettertype - Garamond is voor titels en Rubik voor tekst
const Garamond = "font-serif";
const Rubik = "font-sans";

// Merk kleurencode. Gebruik bg-brand-white in class om toe te passen.
// "brand-white": "#F1F1F1",
// "brand-sage": "#BCBC82",
// "brand-copper": "#C2783F",
// "brand-orange": "#E28F50",

// background: linear-gradient(to right, #3a190c, #8b4b2a, #C2783F, #8b4b2a, #3a190c);

// For ECMAScript (ESM)
// import MailerLite from "@mailerlite/mailerlite-nodejs";

// const params = {
//   email: "dummy1@example.com",
//   groups: ["118882712635311623"],
//   status: "active", // possible statuses: active, unsubscribed, unconfirmed, bounced or junk.
// };

// // addEventListener("submit", (event) => {
// //   mailerlite.subscribers
// //     .createOrUpdate(params)
// //     .then((response) => {
// //       console.log(response.data);
// //     })
// //     .catch((error) => {
// //       if (error.response) console.log(error.response.data);
// //     });
// // });

// mailerlite.subscribers
//   .createOrUpdate(params)
//   .then((response) => {
//     console.log(response.data);
//   })
//   .catch((error) => {
//     if (error.response) console.log(error.response.data);
//   });

// type Props = {
//   mailerlite?: string;
// };

// const { mailerlite } = Astro.props;
---

<script>
  const newPostForm = document.querySelector("#add-post") as HTMLFormElement;
  newPostForm?.addEventListener("submit", async (e) => {
    e.preventDefault();
    const formData = new FormData(newPostForm);
    const values = Object.fromEntries(formData);
    console.log(values);
    // Bij deze stap wordt het naar de server gestuurd/ de backend
    const res = await fetch("/api/emailForm", {
      method: "POST",
      body: JSON.stringify(values),
    });

    console.log(res);
    // Bericht wat komt van de backend/server
    const { message } = await res.json();
    console.log("ðŸš€ ~ newPostForm?.addEventListener ~ message:", message);
  });
</script>

<section class="relative font-sans brief">
  <div class="container px-2 mx-auto">
    <!-- bg-gray-50 -->
    <div class="bg-brand-sage py-5 px-10 rounded-xl">
      <!-- mb-6 py-6 px-6 -->
      <div class=`rounded-xl bg-brand-white`>
        <div class="flex flex-wrap -mx-4">
          <div class="w-full px-4 mb-4 lg:mb-0">
            <!-- action api/emailForm weggehaald -->
            <form class="max-w-md grid gap-4" id="add-post">
              <div class="grid">
                <label for="title">Email</label>
                <input type="text" name="email" id="email" />
              </div>
              <button type="submit" class="text-blue-50 bg-blue-500 p-2"
                >Submit</button
              >
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
